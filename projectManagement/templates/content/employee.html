{% extends "base/index.html" %}
{% block title %}Main Project{% endblock %}
{% block stylecss %}
    <link href="https://fonts.googleapis.com/css?family=Montserrat:300,400,500,600,700" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='assets/css/bootstrap.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='assets/css/font-awesome.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='assets/css/select2.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='assets/css/bootstrap-datetimepicker.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='assets/css/style.css') }}">
{% endblock %}
{{ super() }}
{% block webcontent %}
    <div class="page-wrapper">
                <div class="content container-fluid">
					<div class="row">
						<div class="col-xs-4">
							<h4 class="page-title">Employee</h4>
						</div>
						<div class="col-xs-8 text-right m-b-20">
							<a href="#" class="btn btn-primary rounded pull-right" data-toggle="modal" data-target="#add_employee"><i class="fa fa-plus"></i> Add Employee</a>
							<div class="view-icons">
								<a href="employees.html" class="grid-view btn btn-link active"><i class="fa fa-th"></i></a>
								<a href="employees-list.html" class="list-view btn btn-link"><i class="fa fa-bars"></i></a>
							</div>
						</div>
					</div>
					<div class="row filter-row">
                           <div class="col-sm-3 col-xs-6">
								<div class="form-group form-focus">
									<label class="control-label">Employee ID</label>
									<input type="text" class="form-control floating" />
								</div>
                           </div>
                           <div class="col-sm-3 col-xs-6">
								<div class="form-group form-focus">
									<label class="control-label">Employee Name</label>
									<input type="text" class="form-control floating" />
								</div>
                           </div>
                           <div class="col-sm-3 col-xs-6">
								<div class="form-group form-focus select-focus">
									<label class="control-label">Designation</label>
									<select class="select floating">
										<option value="">Select Designation</option>
										<option value="">Web Developer</option>
										<option value="1">Web Designer</option>
										<option value="1">Android Developer</option>
										<option value="1">Ios Developer</option>
									</select>
								</div>
                           </div>
                           <div class="col-sm-3 col-xs-6">
                                <a href="#" class="btn btn-success btn-block"> Search </a>
                           </div>
                    </div>
					<div class="row staff-grid-row">
						{% for emp in getAllEmp %}
						<div class="col-md-4 col-sm-4 col-xs-6 col-lg-3">
							<div class="profile-widget">
								<div class="profile-img">
									<a href="{{ url_for('empEdtDet', empno=emp.employee_id) }}" class="avatar">{{ emp.initial }}</a>
								</div>
								<div class="dropdown profile-action">
									<a href="#" class="action-icon dropdown-toggle" data-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></a>
									<ul class="dropdown-menu pull-right">
										<li><a href="#" data-toggle="modal" data-target="#edit_employee"><i class="fa fa-pencil m-r-5"></i> Edit</a></li>
										<li><a href="#" data-toggle="modal" data-target="#delete_employee"><i class="fa fa-trash-o m-r-5"></i> Delete</a></li>
									</ul>
								</div>
								<h4 class="user-name m-t-10 m-b-0 text-ellipsis"><a href="{{ url_for('empEdtDet', empno=emp.employee_id) }}">{{ emp.fistname }} {{ emp.lastname }}</a></h4>
								<div class="small text-muted">{{ emp.division_name }}</div>
								<div class="small text-muted">{{ emp.position }}</div>
							</div>
						</div>
						{% endfor %}
					</div>
                </div>
            </div>
    <div id="add_employee" class="modal custom-modal fade" role="dialog">
				<div class="modal-dialog">
					<button type="button" class="close" data-dismiss="modal">&times;</button>
					<div class="modal-content modal-lg">
						<div class="modal-header">
							<h4 class="modal-title">Add Employee</h4>
						</div>
						<div class="modal-body">
							<form role="form" id="addEmpNew" enctype="multipart/form-data">
								<!--basic Information-->
								<div class="card-box">
									<h3 class="card-title">Basic Informations</h3>
									<div class="row">
									<div class="col-md-12">
										<div class="profile-img-wrap">
											<img class="inline-block" src="{{ url_for('static', filename='assets/img/user.jpg') }}" alt="user">
											<div class="fileupload btn btn-default">
												<span class="btn-text">edit</span>
												<input class="upload" type="file">
											</div>
										</div>
										<div class="profile-basic">
											<div class="row">
												<div class="col-md-6">
													<div class="form-group form-focus">
														<label class="control-label">First Name</label>
														<input type="text" class="form-control floating" name="fname" id="fname"/>
													</div>
												</div>
												<div class="col-md-6">
													<div class="form-group form-focus">
														<label class="control-label">Last Name</label>
														<input type="text" class="form-control floating" name="lname" id="lname"/>
													</div>
												</div>
												<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Birth Date</label>
												<div class="cal-icon"><input class="form-control floating datetimepicker" type="text" name="birth" id="birth"/></div>
											</div>
										</div>
												<div class="col-md-6">
													<div class="form-group form-focus select-focus">
														<label class="control-label">Gendar</label>
														<select class="select form-control floating" name="gender" id="gender">
															<option value="0">Select Gendar</option>
															<option value="Male">Male</option>
															<option value="Female">Female</option>
														</select>
													</div>
												</div>
											</div>
										</div>
									</div></div>
								</div>
								<!--contact information-->
								<div class="card-box">
									<h3 class="card-title">Contact Informations</h3>
									<div class="row">
										<div class="col-md-12">
											<div class="form-group form-focus">
												<label class="control-label">Address</label>
												<input type="text" class="form-control floating" name="address" id="address"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Province</label>
												<select class="select form-control floating" name="province" id="province">
													<option value="0">Select Province</option>
													{% for prov in province %}
													<option value="{{ prov.province_id }}">{{ prov.province_name }}</option>
													{% endfor %}
												</select>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">City</label>
												<select class="select from control floating" name="city" id="city">
													<option value="0">Select City</option>
												</select>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Pin Code</label>
												<input type="text" class="form-control floating" id="pincode" name="pincode"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Phone Number</label>
												<input type="text" class="form-control floating" name="phone" id="phone"/>
											</div>
										</div>
									</div>
								</div>
								<!--Information Team-->
								<div class="card-box">
									<h3 class="card-title">Information Team</h3>
									<div class="row">
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">NIK</label>
												<input type="text" class="form-control floating" name="nik" id="nik"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Email</label>
												<input type="email" class="form-control floating" name="email" id="email"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Password</label>
												<input type="password" class="form-control floating" name="password" id="password"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Repeat Password</label>
												<input type="password" class="form-control floating" id="repeat_password" name="repeat_password"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus select-focus">
												<label class="control-label">Division</label>
												<select class="select form-control floating" name="division" id="division">
													<option value="0">Select Division</option>
													{% for dept in deptName %}
													<option value="{{ dept.division_id }}">{{ dept.division_name }}</option>
													{% endfor %}
												</select>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus select-focus">
												<label class="control-label">Job Title</label>
												<select class="select form-control floating" name="job_title" id="job_title">
													<option value="0">Select Job Title</option>
													{% for job in titleName %}
													<option value="{{ job.empTitle_id }}">{{ job.title_name }}</option>
													{% endfor %}
												</select>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Join Date</label>
												<div class="cal-icon"><input type="text" class="form-control floating datetimepicker" name="join_date" id="join_date"/></div>
											</div>
										</div>
									</div>
								</div>
								<!--Education-->
								<div class="card-box">
									<h3 class="card-title">Last Education Informations</h3>
									<div class="row">
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Tingkat</label>
												<select class="form-control floating" id="schoollevel" name="schoollevel">
													<option value="0">Select Derajat</option>
													{% for school in school %}
													<option value="{{ school.school_code }}">{{ school.school_level }}</option>
													{% endfor %}
												</select>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Instituti Name</label>
												<input type="text" class="form-control floating" id="institusi" name="institusi"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Start Date</label>
												<div class="cal-icon"><input type="text" class="form-control floating datetimepicker" name="school_start" id="school_start"/></div>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Completed Date</label>
												<div class="cal-icon"><input type="text" class="form-control floating datetimepicker" name="school_end" id="school_end"/></div>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Degree</label>
												<input type="text" class="form-control floating" name="degree" id="degree"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Grade</label>
												<input type="text" class="form-control floating" name="grade" id="grade"/>
											</div>
										</div>
									</div>
								</div>
								<!--experience-->
								<div class="card-box">
									<h3 class="card-title">Last Experience Informations</h3>
									<div class="row">
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Company Name</label>
												<input type="text" class="form-control floating" name="exp_company" id="exp_company"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Location</label>
												<input type="text" class="form-control floating" name="exp_location" id="exp_location"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Job Position</label>
												<input type="text" class="form-control floating" name="job_position" id="job_position"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Report To</label>
												<input type="text" class="form-control floating" name="report_to" id="report_to"/>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Period From</label>
												<div class="cal-icon"><input type="text" class="form-control floating" datetimepicker name="exp_start" id="exp_start"/></div>
											</div>
										</div>
										<div class="col-md-6">
											<div class="form-group form-focus">
												<label class="control-label">Period To</label>
												<div class="cal-icon"><input type="text" class="form-control floating" datetimepicker id="exp_end" name="exp_end"/></div>
											</div>
										</div>
									</div>
								</div>
								<div class="text-center m-t-20">
									<button class="btn btn-primary btn-lg" type="button" id="addEmployee" name="addEmployee">Submit</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
    <div id="delete_employee" class="modal custom-modal fade" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content modal-md">
						<div class="modal-header">
							<h4 class="modal-title">Delete Employee</h4>
						</div>
						<form>
							<div class="modal-body card-box">
								<p>Are you sure want to delete this?</p>
								<div class="m-t-20"> <a href="#" class="btn btn-default" data-dismiss="modal">Close</a>
									<button type="submit" class="btn btn-danger">Delete</button>
								</div>
							</div>
						</form>
					</div>
				</div>
			</div>
{% endblock %}
{% block js %}
    <script type="text/javascript" src="{{ url_for('static', filename='assets/js/jquery-3.2.1.min.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='assets/js/sweetalert.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='assets/js/bootstrap.min.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='assets/js/jquery.slimscroll.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='assets/js/select2.min.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='assets/js/moment.min.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='assets/js/bootstrap-datetimepicker.min.js') }}"></script>
	<script type="text/javascript" src="{{ url_for('static', filename='assets/js/app.js') }}"></script>
	<script type="text/javascript">

		$(document).ready(function(){
			$("#province").change(function(){
				var prov = $(this).val();

				$.ajax({
					type: "GET",
					url: "http://localhost:14045/city/detail/"+prov,
					success: function(res){
						data = JSON.parse(res);
						console.log(data[0]);
						console.log(data.length);

						(function() {
    						var elm = document.getElementById('city'),
        						df = document.createDocumentFragment();
        						$('#city')
    							.find('option')
    							.remove()
    							.end();
    						for (var i = 0; i < data.length; i++) {
        						var option = document.createElement('option');
        						option.value = data[i]['city_code'];
        						option.appendChild(document.createTextNode(data[i]['city_name']));
        						df.appendChild(option);
    						}
    						elm.appendChild(df);
							}());
					}
				});
			});
		});

	$(function(){
    $('#addEmployee').click(function(){
    	event.preventDefault();
       	var form_data = new FormData($('#addEmpNew')[0]);
        $.ajax({
            url: '{{ url_for('empAdd') }}',
            data: $('form').serialize(),
            type: 'POST',
            success: function(data){
                JSalert();
                function JSalert(){
                    swal("Congrats!", " Data Success created to System ", "success")
                    .then(willRedirect => {
                        if (willRedirect){
                            window.location.href = "{{ url_for('emplAll') }}";
                            }
                    });
                }
            },
            error: function(data){
                console.log(data);
            }
        });
    });
});
	</script>
{% endblock %}